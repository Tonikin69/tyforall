<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Personas | Hacker Login</title>

<style>
  * { box-sizing: border-box; font-family: Consolas, monospace; }
  body { margin:0; min-height:100vh; background:black; overflow:hidden; }
  canvas { position: fixed; inset:0; z-index:0; }

  .center { position:fixed; inset:0; display:flex; align-items:center; justify-content:center; z-index:1; }
  .card {
    background: rgba(0,0,0,0.88);
    border: 1px solid #00ff00;
    color: #00ff00;
    padding:30px;
    width:100%;
    max-width:800px;
    border-radius:10px;
    box-shadow:0 0 30px #00ff00;
  }

  h2 { text-align:center; margin-bottom:25px; letter-spacing:2px; }
  input { width:100%; padding:12px; margin-bottom:15px; background:black; border:1px solid #00ff00; color:#00ff00; border-radius:6px; font-size:15px; }
  input::placeholder { color:#00aa00; }
  button { width:100%; padding:12px; background:#00ff00; border:none; color:black; font-weight:bold; cursor:pointer; border-radius:6px; font-size:16px; }
  button:hover { background:#00cc00; }
  #error { display:none; margin-top:12px; padding:10px; background:#220000; border:1px solid red; color:red; text-align:center; border-radius:6px; }

  table { width:100%; border-collapse: collapse; margin-top:15px; display:none; color:#00ff00; }
  th, td { border:1px solid #00ff00; padding:8px; font-size:14px; text-align:left; }
  th { background: rgba(0,255,0,0.1); }
  .campo { color: #ff3300; font-weight:bold; }  /* campo en rojo */
  .valor { color: #00ff00; }                  /* valor en verde */
</style>
</head>

<body>
<canvas id="matrix"></canvas>

<div class="center">
  <div class="card">
    <h2 id="titulo">ACCESS REQUIRED</h2>

    <div id="login">
      <input id="email" placeholder="EMAIL">
      <input id="password" type="password" placeholder="PASSWORD">
      <button onclick="login()">LOGIN</button>
      <div id="error"></div>
    </div>

    <table id="tabla">
      <thead>
        <tr>
          <th>Usuario</th>
          <th>Fecha</th>
          <th>CPU</th>
          <th>RAM (GB)</th>
          <th>GPU</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
  import { getAuth, signInWithEmailAndPassword, onAuthStateChanged,
           setPersistence, browserSessionPersistence, signOut }
    from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
  import { getDatabase, ref, get }
    from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAqRKw0f831pD_8R-AMX2vJJY4M5mpBz6o",
    authDomain: "personas-firebase.firebaseapp.com",
    databaseURL: "https://personas-firebase-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "personas-firebase",
    storageBucket: "personas-firebase.firebasedestorage.app",
    messagingSenderId: "950578634794",
    appId: "1:950578634794:web:bb1f48b283e97443d06353"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getDatabase(app);

  signOut(auth).catch(() => {});
  setPersistence(auth, browserSessionPersistence);

  window.login = function() {
    const email = document.getElementById("email").value;
    const pass = document.getElementById("password").value;
    const error = document.getElementById("error");
    error.style.display = "none";

    signInWithEmailAndPassword(auth, email, pass)
      .catch(() => {
        error.innerText = "ACCESS DENIED";
        error.style.display = "block";
      });
  };

  onAuthStateChanged(auth, user => {
    if (user) {
      document.getElementById("login").style.display = "none";
      document.getElementById("titulo").innerText = "DATABASE ACCESS";
      cargarDatos();
    }
  });

  function cargarDatos() {
    const tabla = document.getElementById("tabla");
    const tbody = tabla.querySelector("tbody");
    tabla.style.display = "table";
    tbody.innerHTML = "";

    get(ref(db, "personas")).then(snapshot => {
      const data = snapshot.val();
      if (!data) {
        tbody.innerHTML = "<tr><td colspan='5'>No hay datos</td></tr>";
        return;
      }

      for (let id in data) {
        const p = data[id];
        tbody.innerHTML += `<tr>
          <td><span class="campo">usuario:</span> <span class="valor">${p.usuario||""}</span></td>
          <td><span class="campo">fecha:</span> <span class="valor">${p.fecha||""}</span></td>
          <td><span class="campo">cpu:</span> <span class="valor">${p.cpu||""}</span></td>
          <td><span class="campo">ram:</span> <span class="valor">${p.ram_gb||""}</span></td>
          <td><span class="campo">gpu:</span> <span class="valor">${p.gpu||""}</span></td>
        </tr>`;
      }
    });
  }
</script>

<script>
  const canvas = document.getElementById("matrix");
  const ctx = canvas.getContext("2d");

  function resize() { canvas.width=window.innerWidth; canvas.height=window.innerHeight; }
  resize();
  window.addEventListener("resize", resize);

  const chars = "01ABCDEFGHIJKLMNOPQRSTUVWXYZ#$%&@*";
  const fontSize = 16;
  let columns = Math.floor(canvas.width / fontSize);
  let drops = Array(columns).fill(1);

  function draw() {
    ctx.fillStyle = "rgba(0,0,0,0.05)";
    ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle="#00ff00";
    ctx.font = fontSize + "px monospace";

    for(let i=0;i<drops.length;i++){
      const text = chars[Math.floor(Math.random()*chars.length)];
      ctx.fillText(text, i*fontSize, drops[i]*fontSize);
      if(drops[i]*fontSize>canvas.height && Math.random()>0.975) drops[i]=0;
      drops[i]++;
    }
  }

  setInterval(draw,33);
</script>

</body>
</html>
